## Milestone 1.5: Writing Substrate + Flow Navigation

### Milestone goal

Deliver a trustworthy, Notion-grade writing experience across **Exploration** and **Spec** documents, with keyboard-first flow for **lifting**, **switching perspectives**, and **opening/closing core views**—so users can write continuously without thinking about nodes, saving, or UI affordances.

### Success criteria (definition of done)

A user can:

* Write continuously in Exploration and Spec with expected Enter/Backspace/Paste behavior (no “create node” button needed).
* Lift the current semantic scope (block + children) from Exploration into Spec using a single shortcut, even mid-block.
* Switch between Spec and Exploration via one-handed “abstraction” shortcuts without losing cursor position.
* Open and close the View switcher quickly (keyboard + small UI affordance) and navigate between primary surfaces without breaking flow.
* Understand lifted content via subtle, non-intrusive affordances (hover/idle), and jump to source.

---

# MVP Product Surfaces included in Milestone 1.5

## A) Exploration Editor Surface (messy workspace)

* Block editor substrate
* Turnaround loop insertion remains supported, but editor must be usable independent of loops

## B) Spec Editor Surface (curated source of truth)

* Supports both:

  * authored text (for headings/tag scaffolding and framing)
  * lifted/transcluded sections from Exploration

## C) View Switcher (keyboard-first)

A minimal “switch view” UI:

* Opens/closes quickly
* Selects between: Exploration / Spec / (optionally) Tasks / Chats
* External UI affordance: bottom menu or FAB with view list (low visual weight)

---

# Core Behaviors to Implement (Milestone 1.5)

## 1) Core editor behaviors (both docs)

### Required block types

* Paragraph
* Headings (H1/H2/H3)
* Bullets (with nesting)
* (Optional but useful) Checkbox/TODO block

### Required editing behaviors

* **Enter**

  * Creates a new block below
  * In bullets/headings: continues same type
  * Enter on empty styled block exits style to paragraph
* **Backspace**

  * At start of block merges with previous block
  * On empty block deletes block
  * On empty heading/bullet converts to paragraph before delete where appropriate
* **Paste**

  * Multi-paragraph paste → multiple blocks
  * List paste → bullets
* **Undo/Redo** must be reliable and block-aware
* Click-to-place caret must work between blocks

### Explicit removal

* Remove the explicit “Create node” button from the primary flow (it can exist only as a fallback during development, not as the intended UI).

---

## 2) Lifting (single canonical gesture)

### Lifting rule (locked)

* **Lift always lifts the entire semantic scope of the current block**, including children.
* Cursor position does not matter (works mid-block).

### Semantic scope resolution

* H1 lifts until next H1
* H2 lifts until next H2 within same H1
* H3 lifts until next H3 within same H2
* Bullet lifts its nested bullet subtree
* Paragraph lifts itself (and any nested children if your model supports it)

### Shortcut

* **Lift semantic scope (block + children): ⌘ + ⇧ + L**

### Post-lift feedback

* Confirm action unobtrusively (toast or inline hint)
* Insert as lifted/transclusion blocks in Spec
* Add source linkage metadata

---

## 3) Switch between Spec and Exploration (abstraction, not tabs)

### Navigation behavior

* Preserve last caret position per doc
* Maintain a navigation stack so “return down” goes back to where user was

### Shortcuts

* **Go up in abstraction (to Spec): ⌘ + =**
* **Go down in abstraction (to Exploration/source): ⌘ + -**

### Source jump behavior (contextual)

* When cursor is within lifted content in Spec:

  * **Jump to source: ⌘ + ↩**
  * highlights the source block in Exploration

---

## 4) View Switcher (quick open/close)

You proposed `⌘ + ?`—good instinct, but note: on macOS `⌘ + ?` is typically `⌘ + ⇧ + /` and often mapped to “Help” in apps. You can still use it if you’re not inside a browser hotkey conflict; if conflicts occur, use a more standard command palette mapping.

### Recommended shortcut

* **Open/Close View Switcher:** **⌘ + K** (or **⌘ + P**)

  * This mirrors command palette patterns and is discoverable.
  * If you strongly prefer `⌘ + ?`, support it as an alias.

### View Switcher requirements

* Shows primary views:

  * Exploration
  * Spec
  * (Optional for 1.5) Tasks, Conversations
* Keyboard navigation:

  * Up/down to select
  * Enter to open
  * Esc to close
* UI affordance:

  * Small FAB or bottom bar icon that opens the same switcher
  * Visible but low-weight

---

## 5) Visual affordances for lifted content (Spec only)

### Principle

Lifted-ness should be discoverable, not constantly visible.

### MVP treatment

* Default while typing: minimal/no decoration
* On hover or idle:

  * subtle left-edge indicator OR right-gutter icon (choose one)
* One-click “jump to source”
* Source highlight on arrival

---

# Non-goals for Milestone 1.5 (explicitly out-of-scope)

* Multi-doc global knowledge base
* Multi-agent orchestration
* Full normalization/drift UI (engine can exist, but UI can be minimal)
* Drag-and-drop block reordering
* Rich formatting toolbars
* Task metadata beyond status (owner/due dates)
* Collaboration/multi-user

---

# Engineering/Build Notes (high-level)

* Adopt a mature block editor (Tiptap/ProseMirror or Lexical) rather than incrementally patching node creation UX.
* Model both Exploration and Spec as node graphs; Spec supports authored blocks + transclusion blocks.
* Maintain stable node IDs to keep lift references durable.

---

# Deliverables for Milestone 1.5

1. Updated Exploration editor UX (typing-first, no create-node flow)
2. Updated Spec editor UX (authored + lifted blocks)
3. Lift shortcut + semantic scope resolution
4. Abstraction navigation shortcuts + cursor memory
5. View Switcher (keyboard + minimal UI entry)
6. Lifted content affordance states (default/hover/jump)

---

## Next: Core Prompt to Drive Implementation

If you’re ready, I can now write a single **“Milestone 1.5 Build Prompt”** that:

* encodes these behaviors as acceptance tests,
* specifies the data structures (blocks, transclusions, IDs),
* defines edge cases (paste, merge, mid-block lifting),
* and includes the keyboard shortcut map + view switcher behavior.

That prompt can be used for an agentic coding workflow or handed to an engineer as a build spec.
